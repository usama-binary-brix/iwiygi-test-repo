"use client";
import React, { FC, useEffect, useState } from "react";
import { useRouter } from "next/navigation";
import { toast } from "sonner";
import Button from "@/components/button/Button";

const Page: FC = () => {
  const params = new URLSearchParams(location.search);
  const [showSuccess, setShowSuccess] = useState<boolean>(true);
  const [loginBtnLoading, setLoginBtnLoading] = useState<boolean>(false);
  const router = useRouter();
  useEffect(() => {
    if (!params.get("isconnected")) {
      setShowSuccess(false);
    }
  }, [params]);

  console.log(params.get('isconnected'), 'params')

  const handleNavigation = () => {
    router.push("/");
  };
  const handleLoginToStripe = async () => {
    setLoginBtnLoading(true);
    let accessToken = localStorage.getItem("accessToken");
    await fetch(
      `${process.env.NEXT_PUBLIC_API}/api/payments/create-sellerlogin-link`,
      {
        method: "GET",
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${accessToken}`,
        },
      }
    )
      .then((response) => response.json())
      .then((response) => {
        setLoginBtnLoading(false);
        if (response.statusCode === 400) {
          toast.error(response.message);
        } else if (response.statusCode === 404) {
          toast.error("Something Went Wrong");
        } else {
          window.open(response.data, "_blank");
        }
      })
      .catch((error) => {
        setLoginBtnLoading(false);
        toast.error(error.message);
      });
  };
  return (
    <>
      {/* // payment integration */}
      {showSuccess ? (
     <>
 <div className="flex justify-center items-center h-full p-10">
          <center>
            <div>
              <svg
                width="253"
                height="253"
                viewBox="0 0 253 253"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clip-path="url(#clip0_648_1927)">
                  <path
                    d="M217.405 165.582C228.071 165.582 236.717 156.936 236.717 146.27C236.717 135.603 228.071 126.958 217.405 126.958C228.071 126.958 236.717 118.312 236.717 107.646C236.717 96.9811 228.071 88.3336 217.405 88.3336V65.2364C228.071 65.2364 236.717 56.5889 236.717 45.9243C236.717 35.2578 228.071 26.6123 217.405 26.6123H157.355V168.72"
                    fill="#E0935F"
                  />
                  <path
                    d="M110.06 129.95C120.885 108.447 78.7015 108.042 71.1523 85.1856C67.5389 74.2179 55.7258 68.2709 44.7582 71.8901C33.7964 75.5073 27.8493 87.3262 31.4685 98.2822C35.5085 110.541 34.5376 123.638 28.7276 135.171C28.7276 135.171 7.74589 171.471 21.4409 202.023C34.1786 230.444 64.771 250.617 97.1912 252.837C115.828 254.109 134.215 247.957 148.563 235.995L150.833 234.102"
                    fill="#E0935F"
                  />
                  <path
                    d="M75.6034 118.37C75.6034 136.568 48.7171 176.449 75.6034 203.335C102.49 230.222 144.214 147.411 144.214 147.411"
                    fill="#C67842"
                  />
                  <path
                    d="M108.832 252.67C104.986 253.041 101.094 253.104 97.1912 252.836C64.7728 250.616 34.1785 230.443 21.4409 202.023C7.74584 171.471 28.7295 135.171 28.7295 135.171C34.5376 123.637 35.5085 110.541 31.4685 98.2818C27.8493 87.3258 33.7964 75.5069 44.7582 71.8897C49.2942 70.3937 53.9751 70.5308 58.1637 71.992C47.3891 75.7193 41.5791 87.4223 45.1635 98.2818C49.2035 110.541 48.2345 123.637 42.4245 135.171C42.4245 135.171 21.4409 171.471 35.1379 202.023C47.6072 229.843 77.1785 249.759 108.832 252.67Z"
                    fill="#C67842"
                  />
                  <path
                    d="M236.717 45.9245C236.717 56.589 228.071 65.2365 217.405 65.2365V55.6258C226.409 55.6258 233.978 49.4626 236.11 41.1182C236.504 42.6546 236.717 44.2625 236.717 45.9245Z"
                    fill="#C67842"
                  />
                  <path
                    d="M236.717 107.646C236.717 118.313 228.071 126.958 217.405 126.958V117.348C226.409 117.348 233.978 111.184 236.11 102.842C236.504 104.376 236.717 105.986 236.717 107.646Z"
                    fill="#C67842"
                  />
                  <path
                    d="M236.717 146.272C236.717 156.937 228.071 165.582 217.405 165.582V155.972C226.409 155.972 233.978 149.81 236.11 141.466C236.504 143.002 236.717 144.61 236.717 146.272Z"
                    fill="#C67842"
                  />
                  <path
                    d="M202.208 0H86.0248C77.6321 0 70.828 6.80409 70.828 15.1968V218.903C70.828 227.295 77.6321 234.099 86.0248 234.099H202.208C210.6 234.099 217.405 227.295 217.405 218.903V15.1968C217.405 6.80409 210.6 0 202.208 0Z"
                    fill="white"
                  />
                  <path
                    d="M204.53 46.2327V189.862C204.53 196.12 199.453 201.196 193.192 201.196H95.041C91.6187 201.196 88.5438 199.675 86.4688 197.272C84.747 195.29 83.7028 192.695 83.7028 189.862V46.2327C83.7028 39.9691 88.7831 34.8926 95.041 34.8926H193.192C195.143 34.8926 196.983 35.3887 198.581 36.2611C202.127 38.174 204.53 41.9206 204.53 46.2327Z"
                    fill="white"
                  />
                  <path
                    d="M150.719 218.364C150.719 222.012 147.762 224.967 144.115 224.967C140.469 224.967 137.514 222.012 137.514 218.364C137.514 214.718 140.469 211.763 144.115 211.763C147.762 211.763 150.719 214.718 150.719 218.364Z"
                    fill="#302E4F"
                  />
                  <path
                    d="M161.283 19.6268H126.95C124.807 19.6268 123.072 17.8896 123.072 15.747C123.072 13.6064 124.807 11.8691 126.95 11.8691H161.283C163.424 11.8691 165.161 13.6064 165.161 15.747C165.161 17.8896 163.424 19.6268 161.283 19.6268Z"
                    fill="#302E4F"
                  />
                  <path
                    d="M114.401 19.627C112.734 19.627 111.224 18.5133 110.713 16.9305C110.218 15.4037 110.749 13.6993 112.004 12.7033C114.751 10.526 118.87 13.0314 118.212 16.4672C117.864 18.2759 116.25 19.627 114.401 19.627Z"
                    fill="#302E4F"
                  />
                  <path
                    d="M198.583 36.2592L83.7008 151.135V99.7834L148.59 34.8945H193.19C195.145 34.8945 196.981 35.3867 198.583 36.2592Z"
                    fill="white"
                  />
                  <path
                    d="M204.53 60.8086V92.5128L95.8459 201.197H95.041C91.6167 201.197 88.5419 199.676 86.4688 197.273C84.747 195.29 83.7028 192.696 83.7028 189.862V181.638L204.53 60.8086Z"
                    fill="white"
                  />
                  <path
                    d="M193.19 205.076H95.0409C86.6502 205.076 79.8248 198.251 79.8248 189.86V46.2346C79.8248 37.8439 86.6502 31.0166 95.0409 31.0166H193.19C201.58 31.0166 208.408 37.8439 208.408 46.2346V189.86C208.408 198.251 201.58 205.076 193.19 205.076ZM95.0409 38.7723C90.9276 38.7723 87.5805 42.1193 87.5805 46.2346V189.86C87.5805 193.973 90.9276 197.32 95.0409 197.32H193.19C197.305 197.32 200.652 193.973 200.652 189.86V46.2346C200.652 42.1193 197.305 38.7723 193.19 38.7723H95.0409Z"
                    fill="#302E4F"
                  />
                  <path
                    d="M144 78.5C123.337 78.5 106.5 95.3375 106.5 116C106.5 136.663 123.337 153.5 144 153.5C164.663 153.5 181.5 136.663 181.5 116C181.5 95.3375 164.663 78.5 144 78.5ZM161.925 107.375L140.662 128.638C140.137 129.162 139.425 129.463 138.675 129.463C137.925 129.463 137.213 129.162 136.688 128.638L126.075 118.025C124.987 116.938 124.987 115.137 126.075 114.05C127.162 112.962 128.962 112.962 130.05 114.05L138.675 122.675L157.95 103.4C159.038 102.313 160.838 102.313 161.925 103.4C163.013 104.488 163.013 106.25 161.925 107.375Z"
                    fill="#03F719"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_648_1927">
                    <rect width="253" height="253" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <h1 className="text-[#26CE32]  fw-bold text-4xl">
              Your Stripe Account has been created !
            </h1>
            {/* <p className="text-[#E6E7E5] text-normal">
              Account verification is currently in process.{" "}
            </p> */}
            {/* <p className="text-[#E6E7E5] text-normal">
              {" "}
              Youâ€™ll receive an email notification when the process is complete.{" "}
            </p> */}


            <div className="flex gap-2 items-center justify-center mt-5">
            

              <Button
                text="Save & Continue"
                onClick={handleNavigation}
                type={"success"}
              />
            </div>
          </center>
        </div>
     </>
      ):(
        <>
     <div className="flex justify-center items-center h-full">
          <center className="p-10">
            <div>
              <svg
                width="253"
                height="253"
                viewBox="0 0 253 253"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clip-path="url(#clip0_696_130)">
                  <path
                    d="M217.405 165.582C228.071 165.582 236.717 156.936 236.717 146.27C236.717 135.603 228.071 126.958 217.405 126.958C228.071 126.958 236.717 118.312 236.717 107.646C236.717 96.9811 228.071 88.3336 217.405 88.3336V65.2364C228.071 65.2364 236.717 56.5889 236.717 45.9243C236.717 35.2578 228.071 26.6123 217.405 26.6123H157.355V168.72"
                    fill="#E0935F"
                  />
                  <path
                    d="M110.06 129.95C120.885 108.447 78.7014 108.042 71.1522 85.1856C67.5388 74.2179 55.7257 68.2709 44.7581 71.8901C33.7963 75.5073 27.8492 87.3262 31.4684 98.2822C35.5084 110.541 34.5375 123.638 28.7275 135.171C28.7275 135.171 7.74577 171.471 21.4408 202.023C34.1785 230.444 64.7708 250.617 97.1911 252.836C115.828 254.109 134.215 247.957 148.563 235.995L150.832 234.102"
                    fill="#E0935F"
                  />
                  <path
                    d="M75.6035 118.37C75.6035 136.568 48.7172 176.449 75.6035 203.335C102.49 230.222 144.214 147.411 144.214 147.411"
                    fill="#C67842"
                  />
                  <path
                    d="M108.833 252.67C104.986 253.041 101.094 253.104 97.1913 252.836C64.773 250.616 34.1787 230.443 21.441 202.023C7.74596 171.471 28.7296 135.171 28.7296 135.171C34.5377 123.637 35.5086 110.541 31.4686 98.2818C27.8494 87.3258 33.7965 75.5069 44.7583 71.8897C49.2944 70.3937 53.9752 70.5308 58.1638 71.992C47.3892 75.7193 41.5792 87.4223 45.1637 98.2818C49.2036 110.541 48.2347 123.637 42.4246 135.171C42.4246 135.171 21.441 171.471 35.138 202.023C47.6073 229.843 77.1786 249.759 108.833 252.67Z"
                    fill="#C67842"
                  />
                  <path
                    d="M236.717 45.9245C236.717 56.589 228.071 65.2365 217.405 65.2365V55.6258C226.409 55.6258 233.978 49.4626 236.111 41.1182C236.505 42.6546 236.717 44.2625 236.717 45.9245Z"
                    fill="#C67842"
                  />
                  <path
                    d="M236.717 107.646C236.717 118.313 228.071 126.958 217.405 126.958V117.348C226.409 117.348 233.978 111.184 236.111 102.842C236.505 104.376 236.717 105.986 236.717 107.646Z"
                    fill="#C67842"
                  />
                  <path
                    d="M236.717 146.272C236.717 156.937 228.071 165.582 217.405 165.582V155.972C226.409 155.972 233.978 149.81 236.111 141.466C236.505 143.002 236.717 144.61 236.717 146.272Z"
                    fill="#C67842"
                  />
                  <path
                    d="M202.208 0H86.0249C77.6322 0 70.8281 6.80409 70.8281 15.1968V218.903C70.8281 227.295 77.6322 234.099 86.0249 234.099H202.208C210.601 234.099 217.405 227.295 217.405 218.903V15.1968C217.405 6.80409 210.601 0 202.208 0Z"
                    fill="white"
                  />
                  <path
                    d="M204.53 46.2327V189.862C204.53 196.12 199.453 201.196 193.192 201.196H95.0409C91.6185 201.196 88.5437 199.675 86.4687 197.272C84.7469 195.29 83.7026 192.695 83.7026 189.862V46.2327C83.7026 39.9691 88.783 34.8926 95.0409 34.8926H193.192C195.143 34.8926 196.983 35.3887 198.581 36.2611C202.127 38.174 204.53 41.9206 204.53 46.2327Z"
                    fill="white"
                  />
                  <path
                    d="M150.719 218.364C150.719 222.012 147.762 224.967 144.115 224.967C140.469 224.967 137.514 222.012 137.514 218.364C137.514 214.718 140.469 211.763 144.115 211.763C147.762 211.763 150.719 214.718 150.719 218.364Z"
                    fill="#302E4F"
                  />
                  <path
                    d="M161.283 19.6268H126.95C124.807 19.6268 123.072 17.8896 123.072 15.747C123.072 13.6064 124.807 11.8691 126.95 11.8691H161.283C163.423 11.8691 165.161 13.6064 165.161 15.747C165.161 17.8896 163.423 19.6268 161.283 19.6268Z"
                    fill="#302E4F"
                  />
                  <path
                    d="M114.401 19.627C112.734 19.627 111.224 18.5133 110.713 16.9305C110.219 15.4037 110.749 13.6993 112.004 12.7033C114.751 10.526 118.87 13.0314 118.212 16.4672C117.864 18.2759 116.251 19.627 114.401 19.627Z"
                    fill="#302E4F"
                  />
                  <path
                    d="M198.583 36.2592L83.7007 151.135V99.7834L148.59 34.8945H193.19C195.145 34.8945 196.981 35.3867 198.583 36.2592Z"
                    fill="white"
                  />
                  <path
                    d="M204.53 60.8086V92.5128L95.8458 201.197H95.0409C91.6166 201.197 88.5417 199.676 86.4687 197.273C84.7469 195.29 83.7026 192.696 83.7026 189.862V181.638L204.53 60.8086Z"
                    fill="white"
                  />
                  <path
                    d="M193.19 205.076H95.041C86.6503 205.076 79.825 198.251 79.825 189.86V46.2346C79.825 37.8439 86.6503 31.0166 95.041 31.0166H193.19C201.581 31.0166 208.408 37.8439 208.408 46.2346V189.86C208.408 198.251 201.581 205.076 193.19 205.076ZM95.041 38.7723C90.9277 38.7723 87.5807 42.1193 87.5807 46.2346V189.86C87.5807 193.973 90.9277 197.32 95.041 197.32H193.19C197.305 197.32 200.652 193.973 200.652 189.86V46.2346C200.652 42.1193 197.305 38.7723 193.19 38.7723H95.041Z"
                    fill="#302E4F"
                  />
                  <g clip-path="url(#clip1_696_130)">
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M157.759 126.07C158.675 126.996 158.675 128.516 157.759 129.443C156.844 130.369 155.359 130.369 154.442 129.443L144.514 119.373L134.516 129.514C133.592 130.44 132.097 130.44 131.173 129.514C130.252 128.564 130.252 127.044 131.173 126.118L141.172 115.976L131.244 105.93C130.327 105.004 130.327 103.484 131.244 102.557C132.155 101.631 133.641 101.631 134.558 102.557L144.486 112.627L154.559 102.415C155.483 101.489 156.976 101.489 157.899 102.415C158.82 103.365 158.82 104.861 157.899 105.811L147.828 116.024L157.759 126.07ZM144.5 78C123.788 78 107 95.005 107 116C107 136.995 123.788 154 144.5 154C165.212 154 182 136.995 182 116C182 95.005 165.212 78 144.5 78Z"
                      fill="#FF0000"
                    />
                  </g>
                </g>
                <defs>
                  <clipPath id="clip0_696_130">
                    <rect width="253" height="253" fill="white" />
                  </clipPath>
                  <clipPath id="clip1_696_130">
                    <rect
                      width="75"
                      height="76"
                      fill="white"
                      transform="translate(107 78)"
                    />
                  </clipPath>
                </defs>
              </svg>
            </div>
            <h1 className="text-[#ce2626]  fw-bold text-4xl">
              Something Went Wrong
            </h1>
            <p className="text-[#E6E7E5] text-normal">
              Click the button below to start the onboarding process.
            </p>
            <div className="flex gap-2 items-center justify-center mt-5">
             
             <Button text="Connect Stripe" 
                onClick={handleLoginToStripe}
             loading={loginBtnLoading}
             type={'success'}
             />
             <Button text=" Leave Process" 
                onClick={handleNavigation}
           
             type={'danger'}
             />
             
              {/* <button
                onClick={handleLoginToStripe}
                className=" text-base font-bold leading-tight text-dark text-center border-2 border-bright-green bg-[#03F719] rounded-[50%] px-10 cursor-pointer h-[84px]"
                disabled={loginBtnLoading}
              >
                {!loginBtnLoading ? "Connect with Stripe" : "Loading..."}
              </button> */}
              {/* <button
                onClick={handleNavigation}
                className="text-center border-2 border-bright-green rounded-[50%] px-16  text-base font-bold leading-tight text-[#03F719] h-[84px]"
              >
                Leave Process
              </button> */}
            </div>
          </center>
        </div>
        
        </>
      )
      
      }

      {/* // connect succesfully */}
      
    </>
  );
};

export default Page;
